### 编码规范-PHP篇

本编码规范是参考多个优秀项目的编码规范并结合自身的编码风格制定而成，只为统一代码风格，减少多人协作时的不便。

* [注释](#注释)
* [文件格式](#文件格式)
* [命名规范](#命名规范)

#### 注释

##### 单行注释

单行注释可以显示在一行内，并与其后的代码具有一样的缩进层级。如果一个注释不能在一行内写完，就该采用块注释。单行注释之前应该有一个空行。以下是一个代码中单行注释的例子：

```php
if ($condition) {

    // 第一种单行注释
    ...

    /* 第二种单行注释 */
    ...
}
```

单行注释也可以和代码写在同一行，如下：

```php
if (true) { // 第一种注释
	...
} else {    /* 第二种注释 */
	...
}
```

##### 块注释

块注释通常用于提供对文件，方法，数据结构和算法的描述。块注释被置于每个文件的开始处以及每个方法之前。它们也可以被用于其他地方，比如方法内部。在功能和方法内部的块注释应该和它们所描述的代码具有一样的缩进格式。

块注释之首应该有一个空行，用于把块注释和代码分割开来，比如：

```php
echo "hello world";

/*
 * 这里是块注释
 */
```



推荐使用第一种单行注释。

##### 文档注释

文档注释描述php的类、方法，每个文档注释都会被置于注释定界符`/**...*/`之中，一个注释对应一个类或成员。该注释应位于声明之前：

```php
/**
 * 这个类的文档注释 ...
 */
class Example { ...
```

描述类的文档注释的第一行(/**)不需缩进；随后的文档注释每行都缩进1格(使星号纵向对齐)。成员，包括构造函数在内，其文档注释的第一行缩进4格，随后每行都缩进5格。

若你想给出有关类、变量或方法的信息，而这些信息又不适合写在文档中，则可使用块注释或紧跟在声明后面的单行注释。例如，有关一个类实现的细节，应放入紧跟在类声明后面的实现块注释中，而不是放在文档注释中。

文档注释不能放在一个方法或构造器的定义块中，因为程序会将位于文档注释之后的第一个声明与其相关联。

##### 开头注释

所有的源文件都应该在开头有一个C语言风格的注释，其中列出类名、功能、版本信息、日期、作者和版权声明：

```php
/*
 * 类名
 * 功能
 * 版本
 * 日期
 * 作者
 * 版权
 */
 ```

如果对文件进行了修改，应该在文件头中说明修改目的、修改日期、修改人，并变更文件的版本信息；如果修改文件的一部分，则在文件中进行注释即可，并且标识出修改部分的起止位置

```php
/*
 * 修改目的
 * 修改日期
 * 修改人
 * 版本
 */
```

```php
//修改起始
.....
//修改结束
```

#### 文件格式

* php 代码必须使用完整标签`<?php … ?>`，不要使用php 短标签`<? … ?>`，且保证在关闭标签后不要有任何空格。对于只含有 php 代码的文件，我们将在文件结尾处忽略掉 "?>" 。这是为了防止多余的空格或者其它字符影响到代码。
* 每个代码行不要超过80列，一个字符为一列，包含缩进字符
* 缩进为4个空格,如果编辑器支持，可设置`Tab`键为4个空格
* 嵌套不要太多，超过3个嵌套时要重构代码
* 一个php文件只能包含一个类
* 每行只有一条语句切记不要在同一行内写多条语句。

#### 命名规范

制定统一的命名规范对于项目开发来说非常重要，不但可以养成程序员一个良好的开发习惯，还能增加程序的可读性、可移植性和可重用性，还能很好的提高项目开发的效率。请注意，命名请尽量使用英文的全拼形式。

##### 变量（属性）命名
变量命名包括普通变量、静态变量、局部变量、全局变量、Session变量等方面的命名规则。

变量命名遵循以下规则：
* 所有字母都使用小写
* 多个单词间不使用间隔，除第一个单词外，其他单词首字母大写（驼峰式）

例：`$baseDir`、`$redRosePrice`等

##### 常量命名

常量命名遵循以下规则：
* 所有字母都使用大写
* 对于一个常量使用多个单词的，使用下划线“_”作为分隔符

例：`FIRST`、`SECOND_NAME`等

##### 类命名

php中类命名遵循以下规则：
* 以大写字母开头；
* 多个单词组成的变量名，单词之间不用间隔，各个单词首字母大写

例：`class MyClass` 或`class DbOracle`等。

##### 函数（方法）命名
方法或函数命名遵循以下规则：
* 首字母小写；
* 多个单词间不使用间隔，除第一个单词外，其他单词首字母大写。

例：`function myFunction()`或`function myDbOracle()`等。



#### 大括号{ }书写规则

在程序中进行结构控制代码编写，如if、for、while、switch、函数等结构，大括号传统的有两种书写习惯，分别如下：
1． `{` 直接跟在控制语句之后，不换行，如

```php
for ($i = 0; $i < $count; $i++) {
	echo "test";
}
```

2．`{` 在控制语句下一行，如

```php
for($i = 0; $i < $count; $i++)
{
	echo "test";
}
```

其中，1 是PEAR建议的方式，但是从实际书写中来讲，这并不影响程序的规范和影响用phpdoc实现文档，所以可以根据个人习惯来采用上面的两种方式，但是要求在同一个程序中，只使用其中一种，以免造成阅读的不方便。推荐使用第一种。

##### 小括号( )和函数、关键词等
小括号、关键词和函数遵循以下规则：
* 不要把小括号和关键词紧贴在一起，要用一个空格间隔；如if ( $a<$b )；
* 小括号和函数名间没有空格；如$test = date("ymdhis")；
* 除非必要，不要在Return返回语句中使用小括号。 如Return $a；

##### ＝符号书写
在程序中`=`符号的书写遵循以下规则：
* 在=符号的两侧，均需留出一个空格；如$a = $b 、if ($a = = $b)等；
* 在一个申明块，或者实现同样功能的一个块中，要求=号尽量上下对其，左边可以为了保持对齐使用多个空格，而右边要求空一个空格；

如下例：
$testa = $aaa;
$testaa = $bbb;
$testaaa = $ccc;

#### 变量定义
XXX环境下的php代码编写要求所有的变量均需要先申明后使用，否则会有错误信息，对于数组，在使用一个不确定的key时，比如先进行isset()的判断，然后再使用；比如下面的代码：
```php
$array = array();
$var = isset($array[3]) ? $array[3] : "";
```

#### 对返回值进行比较以及类型转换

有一些 PHP 函数在失败时返回 FALSE ，但是也可能会返回 "" 或 0 这样的有效值， 这些值在松散类型比较时和 FALSE 是相等的。所以当你在条件中使用这些返回值作比较时， 一定要使用严格类型比较，确保返回值确实是你想要的，而不是松散类型的其他值。
在检查你自己的返回值和变量时也要遵循这种严格的方式，必要时使用 `===` 和 `!==` 。

#### 代码缩进
代码的缩进字符个数统一为4个字符，可设置编辑器的`Tab`键为4个空格。

#### 字符串
字符串使用单引号引起来，当字符串中有变量时使用双引号，并且使用大括号将变量包起来。 另外，当字符串中有单引号时，也应该使用双引号，这样就不用使用转义符。

### 实例说明

#### 变量
错误的：
```php
$a = 1;          //变量名无意义
$num=4;          //等号两边没有加空格
$name = "test";  //字符串中无变量及转义字符时要用单引号
```

正确的：
```php
$age = 1;
$num = 4;
$name = 'test';
```

#### 常量
错误的：
```php

```

正确的：
```php

```